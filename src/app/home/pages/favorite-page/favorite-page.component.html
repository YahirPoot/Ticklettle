<div class="w-full min-h-screen flex flex-col">

  @if (!isAuthenticated()) {
    <shared-is-not-authenticated
      [message]="'Debes iniciar sesión para poder agregar tus favoritos '"
    />
  } @else {

    @if (showSuccess()) {
      <div class="fixed top-4 right-4 z-50">
        <div class="alert alert-success shadow-lg">
          <div class="flex items-center gap-3">
            <mat-icon>check_circle</mat-icon>
            <span>Eliminado correctamente</span>
          </div>
        </div>
      </div>
    }
    <!-- mostrar estado vacío o favoritos según el resource -->
    @if (!favoritesResource.isLoading() && favorites.length === 0) {

      <div class="max-w-6xl mx-auto">
        <div class="card bg-base-200 border border-base-300 rounded-lg p-6 flex flex-col items-center justify-center gap-4 w-full">

          <svg class="w-16 h-16 text-red-500 animate-pulse" viewBox="0 0 24 24" fill="none">
            <path
              d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 1 0-7.78 7.78L12 21.23l8.84-8.84a5.5 5.5 0 0 0 0-7.78z"
              stroke="currentColor" stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
              class="fill-current/5"
            />
          </svg>

          <h3 class="text-2xl font-semibold">Aún no tienes favoritos</h3>

          <p class="text-sm text-gray-500 max-w-lg text-center">
            Marca con el corazón los eventos que te interesen para encontrarlos fácilmente más tarde.
          </p>

          <div class="flex gap-3">
            <a routerLink="/" class="btn btn-primary">
              Explorar eventos
            </a>
          </div>

        </div>
      </div>

    } @else {

      <!-- Navbar superior (solo cuando hay favoritos) -->
      <div class="navbar bg-base-200 px-4 py-2 shadow-sm flex justify-between items-center rounded-2xl">
        <h2 class="text-lg font-semibold">Favoritos</h2>
        <div class="flex gap-3 items-center"></div>
      </div>

      <!-- Contenedor principal -->
      <div class="p-6 max-w-7xl mx-auto w-full">

        <!-- Grid -->
        <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-6">

          @for (eventFav of favorites; track eventFav.eventId) {

            <article class="card bg-base-200 shadow-md p-4 flex flex-col gap-3">

              <div>
                <p class="text-sm text-muted">{{eventFav.organizingHouseId}}</p>
                <h3 class="text-lg font-bold">Evento {{ eventFav.name }}</h3>
                <p class="text-sm text-gray-600">{{eventFav.description}}</p>
              </div>

              <div class="w-full flex justify-center">
                <figure class="w-28 h-28 md:w-32 md:h-32 shrink-0">
                  <img
                    src="{{eventFav.imageUrl}}"
                    alt="Evento {{eventFav.name}}"
                    class="w-full h-full object-cover rounded-bl-lg"
                  />
                </figure>
              </div>

              <div class="flex items-center justify-between mt-2">
                <a class="btn btn-ghost btn-sm" [routerLink]="['', 'detail-event', eventFav.eventId]">
                  Ver detalles
                </a>

                <div class="flex items-center gap-2">
                  <button class="btn btn-ghost btn-sm">
                    <mat-icon class="text-red-600">favorite</mat-icon>
                  </button>

                  <button
                    class="btn btn-ghost btn-sm"
                    (click)="openConfirm(eventFav.eventId, eventFav.name)"
                  >
                    <mat-icon>delete</mat-icon>
                  </button>
                </div>
              </div>

            </article>

          }

        </div>

      </div>

    }

    <!-- MODAL REUTILIZABLE -->
    <confirm-modal
      [show]="showConfirm()"
      [modalTitle]="'¿Seguro que desea eliminar el evento?'"
      icon="delete"
      iconColor="text-red-600"
      confirmText="Eliminar"
      cancelText="Cancelar"
      (confirm)="confirmDelete()"
      (cancel)="cancelConfirm()"
    />

  }

</div>
