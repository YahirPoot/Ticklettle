<div class="min-h-screen flex items-center justify-center p-6 bg-base-200">
  <div class="max-w-3xl w-full bg-base-100 rounded-lg shadow-md p-6">
    <div class="flex items-start justify-between gap-4">
      <div>
        <h2 class="text-2xl font-semibold text-primary">Pago realizado</h2>
        <p class="text-sm text-secondary mt-1">Orden <span class="font-medium text-primary">{{ order?.orderNumber || order?.orderId || '—' }}</span></p>
      </div>
      <div class="text-right">
        <div class="text-sm text-secondary">Estado</div>
        <div class="inline-block px-3 py-1 rounded-full font-medium"
             [ngClass]="{
               'bg-green-100 text-green-700': order?.status === 'completed' || order?.payment?.status === 'succeeded',
               'bg-yellow-100 text-yellow-700': order?.status === 'processing',
               'bg-red-100 text-red-700': order?.status === 'failed'
             }">
          {{ order?.payment?.status || order?.status || '—' }}
        </div>
      </div>
    </div>

    <div class="mt-6 grid grid-cols-1 md:grid-cols-2 gap-4">
      <div class="p-4 border rounded">
        <div class="text-sm text-secondary">Resumen</div>
        <div class="mt-2">
          <div class="text-sm text-secondary">Venta ID</div>
          <div class="font-medium text-primary">{{ order?.saleId || '—' }}</div>

          <div class="mt-3 text-sm text-secondary">Comprador (attendee)</div>
          <div class="font-medium text-primary">{{ order?.attendeeId || '—' }}</div>

          <div class="mt-3 text-sm text-secondary">Fecha</div>
          <div class="font-medium text-primary">{{ order?.createdAt | date:'medium' }}</div>
        </div>
      </div>

      <div class="p-4 border rounded bg-primary/5">
        <div class="text-sm text-secondary">Total pagado</div>
        <div class="mt-1 text-xl font-bold text-primary">{{ formatted(order?.totalAmount) }}</div>

        <div class="mt-3 text-sm text-secondary">Método / Pago</div>
        <div class="font-medium text-primary break-words">{{ order?.payment?.paymentIntentId || '—' }}</div>
        <div class="text-sm text-secondary mt-1">Monto: {{ formatted(order?.payment?.amount) }}</div>
        <div class="text-sm text-secondary">Fecha pago: {{ order?.payment?.createdAt | date:'medium' }}</div>
      </div>
    </div>

    <div class="mt-6">
        <h4 class="text-sm font-medium text-primary mb-2">Items</h4>
        <ul class="divide-y">
            @for (it of order.itmes; track $index) {
                <li class="py-3 flex justify-between items-center">
                    <div>
                        <div class="text-sm font-medium text-secondary">{{ it.itemName }}</div>
                        <div class="text-xs text-secondary/70">Tipo: {{ it.type }}</div>
                    </div>
                    <div class="text-right">
                        <div class="text-sm text-secondary">x{{ it.quantity }}</div>
                        <div class="font-semibold text-primary">{{ formatted(it.totalPrice || (it.unitPrice * it.quantity)) }}</div>
                    </div>
                </li>
            }
        </ul>
    </div>

    <div class="mt-6 flex gap-3">
      <button class="btn btn-primary" (click)="downloadTickets()">Descargar boletos</button>
      <a [routerLink]="['/', 'tickets']" class="btn btn-ghost">Ver orden</a>
      <button class="btn btn-outline ml-auto" (click)="contactSupport()">Contactar soporte</button>
    </div>
  </div>
</div>